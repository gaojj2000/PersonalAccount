<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>个人用户系统</title>
		<link rel="stylesheet" href="css/layui.css" />
		<link rel="stylesheet" href="css/modules/layer/default/layer.css" />
	</head>
	<body>
		<div class="layui-layout layui-layout-admin">
			<div class="layui-header">
				<div class="layui-logo layui-hide-xs layui-bg-black">个人财产后台</div>
				<ul class="layui-nav layui-layout-left" id="nav">
					<li class="layui-nav-item layui-hide-xs"><a href="javascript:ast();input();">信息添加</a></li>
					<li class="layui-nav-item layui-hide-xs"><a href="javascript:ast();search();">信息查询</a></li>
				</ul>
				<ul class="layui-nav layui-layout-right">
					<li class="layui-nav-item layui-hide layui-show-md-inline-block">
						<a id="user" href="javascript:;"></a>
						<dl class="layui-nav-child">
							<dd><a href="javascript:ast();settings();">账户设置</a></dd>
							<dd><a href="javascript:ast();logout();">退出登录</a></dd>
						</dl>
					</li>
				</ul>
			</div>
			<div class="layui-side layui-bg-black">
				<div class="layui-side-scroll">
					<ul class="layui-nav layui-nav-tree" lay-filter="test">
						<li id="t1" class="layui-nav-item layui-nav-itemed">
							<a href="javascript:ast('t1');">家庭资金收入图</a>
							<dl class="layui-nav-child">
								<dd><a href="javascript:as1('z1');" class="layui-this">周收入图</a></dd>
								<dd><a href="javascript:as1('y1');">月收入图</a></dd>
								<dd><a href="javascript:as1('n1');">年收入图</a></dd>
							</dl>
						</li>
						<li id="t2" class="layui-nav-item">
							<a href="javascript:ast('t2');">家庭资金支出图</a>
							<dl class="layui-nav-child">
								<dd><a href="javascript:as2('z2');" class="layui-this">周支出图</a></dd>
								<dd><a href="javascript:as2('y2');">月支出图</a></dd>
								<dd><a href="javascript:as2('n2');">年支出图</a></dd>
							</dl>
						</li>
					</ul>
				</div>
			</div>
			<div class="layui-body">
				<div id="main">
					<iframe width="100%" height="100%" src="echarts_show.html?date" style="border: 0;position: absolute;"></iframe>
				</div>
			</div>
			<div class="layui-footer" style="text-align: center;">一家之主的控制台</div>
		</div>
		<script src="js/jquery-3.4.1.min.js"></script>
		<script src="js/jquery.cookie.js"></script>
		<script src="js/layui.js" charset="utf-8"></script>
		<script>
			var url = "127.0.0.1:6699";
			if ($.cookie("user") == undefined) {
				window.location.href = 'index.html';
			}
			function ast(id) {
				id = id || "";
				if (id == 't1') {
					$('#t1').addClass("layui-nav-itemed");
					$('#t2').removeClass("layui-nav-itemed");
					$('#nav li').each(function(){$(this).removeClass('layui-this');});
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?date" style="border: 0;position: absolute;"></iframe>');
				}
				else if (id == 't2') {
					$('#t1').removeClass("layui-nav-itemed");
					$('#t2').addClass("layui-nav-itemed");
					$('#nav li').each(function(){$(this).removeClass('layui-this');});
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?date-" style="border: 0;position: absolute;"></iframe>');
				}
				else {
					$('#t1').removeClass("layui-nav-itemed");
					$('#t2').removeClass("layui-nav-itemed");
				}
			}
			function as1(a) {
				if (a == 'z1') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?date" style="border: 0;position: absolute;"></iframe>');
				}
				else if (a == 'y1') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?month" style="border: 0;position: absolute;"></iframe>');
				}
				else if (a == 'n1') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?year" style="border: 0;position: absolute;"></iframe>');
				}
			}
			function as2(a) {
				if (a == 'z2') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?date-" style="border: 0;position: absolute;"></iframe>');
				}
				else if (a == 'y2') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?month-" style="border: 0;position: absolute;"></iframe>');
				}
				else if (a == 'n2') {
					$('#main').html('<iframe width="100%" height="100%" src="echarts_show.html?year-" style="border: 0;position: absolute;"></iframe>');
				}
			}
			function input() {
				$('#main').html('<iframe width="100%" height="100%" src="input_.html" style="border: 0;position: absolute;"></iframe>');
			}
			function search() {
				$('#main').html('<iframe width="100%" height="100%" src="search_.html" style="border: 0;position: absolute;"></iframe>');
			}
			function settings() {
				$('#nav li').each(function(){$(this).removeClass('layui-this');});
				$('#main').html('<iframe width="100%" height="100%" src="settings.html" style="border: 0;position: absolute;"></iframe>');
			}
			function logout() {
				$('#nav li').each(function(){$(this).removeClass('layui-this');});
				$.ajax({
					type: "get",
					async: true,
					url: "http://" + url + "/logout",
					dataType: "json",
					crossDomain: true,
					xhrFields:{ withCredentials: true },
					success: function (data) {
						layer.msg(eval(data).res, {
							time: 1000,
							icon: 1
						});
						setTimeout('window.location.href="index.html"', 1000);
					},
					error: function (err) {
						note(err.responseText);
					}
				})
			}
			layui.use(function() {
				var layer = layui.layer;
				$.ajax({
					type: "get",
					async: true,
					url: "http://" + url + "/names",
					dataType: "json",
					crossDomain: true,
					xhrFields: {
						withCredentials: true
					},
					success: function(data) {
						if (eval(data).code) {
							$("#user").html('<img src="https://img0.baidu.com/it/u=2351695989,356581044&fm=26&fmt=auto&gp=0.jpg" class="layui-nav-img">' + eval(data).res.name);
						} else {
							layer.msg(eval(data).res, {
								time: 1000,
								icon: 2
							});
							setTimeout('window.location.href = "index.html"', 1000);
						}
					},
					error: function(err) {
						layer.msg(err.responseText, {
							time: 1000,
							icon: 2
						});
						setTimeout('window.location.href = "index.html"', 1000);
					}
				});
			});
		</script>

	</body>
</html>
